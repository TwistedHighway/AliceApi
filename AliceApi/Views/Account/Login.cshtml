@using AliceApi.ViewModels
@model LoginModel

@{
    ViewBag.Title = "Log in";
}

<hgroup class="title">
    <h1>@ViewBag.Title.</h1>
</hgroup>
@*<script src="//js.live.net/v5.0/wl.js"></script>
<script src="//js.live.net/v5.0/wl.debug.js"></script>
<script src="//js.live.net/v5.0/ja/wl.js"></script>
<script src="///LiveSDKHTML/js/wl.js"></script>*@
<section id="loginForm">
<h2>Use a local account to log in.</h2>
@using (Html.BeginForm(new { ReturnUrl = ViewBag.ReturnUrl })) {
    @Html.AntiForgeryToken()
    @Html.ValidationSummary(true)

    <fieldset>
        <legend>Log in Form</legend>
        <ol>
            <li>
                @Html.LabelFor(m => m.UserName)
                @Html.TextBoxFor(m => m.UserName)
                @Html.ValidationMessageFor(m => m.UserName)
            </li>
            <li>
                @Html.LabelFor(m => m.Password)
                @Html.PasswordFor(m => m.Password)
                @Html.ValidationMessageFor(m => m.Password)
            </li>
            <li>
                @Html.CheckBoxFor(m => m.RememberMe)
                @Html.LabelFor(m => m.RememberMe, new { @class = "checkbox" })
            </li>
        </ol>
        <input type="submit" value="Log in" />
    </fieldset>
    <p>
        @Html.ActionLink("Register", "Register") if you don't have an account.
    </p>
    
    
    <p> <input type="button" value="Login" onclick="onLogin();" /></p>
}
</section>

<section class="social" id="socialLoginForm">
    <h2>Use another service to log in.</h2>
    @*@Html.Action("ExternalLoginsList", new { ReturnUrl = ViewBag.ReturnUrl })*@
    @Html.Partial("_ExternalLoginsListPartial", new ExternalLoginListViewModel { ReturnUrl = ViewBag.ReturnUrl })
</section>


<script type="text/javascript">
    
    $(document).ready(function() {


        ////Header.getInstance().initialize("0000000048087436",
        ////    "http://isdk.dev.live.com/dev/isdk/callback.aspx",
        ////    "https://js.live.net/v5.0/en/wl.js",
        ////    'Sign in ',
        ////    'Sign out',
        ////    "PROD");

        //var clientId = "0000000048087436";
        //var redirectUri = "http://localhost/AliceApi/";
        //WL.init({ client_id: clientId, redirect_uri: redirectUri });
        //WL.Event.subscribe("auth.login", onLogin);
        //WL.Event.subscribe("auth.sessionChange", onSessionChange);

        //var session = WL.getSession();
        //if (session) {
        //    log("You are already signed in!");
        //} else {
        //    WL.login({ scope: "wl.signin" });
        //}
        

    });
    

    //function onLogin() {
    //    var session = WL.getSession();
    //    if (session) {
    //        log("You are signed in!");
    //    }
    //}
 
    //function onSessionChange() {
    //    var session = WL.getSession();
    //    if (session) {
    //        log("Your session has changed.");
    //    }
    //}
                    
    //function log(message) {
    //    var child = document.createTextNode(message);
    //    var parent = document.getElementById('JsOutputDiv') || document.body;
    //    parent.appendChild(child);
    //    parent.appendChild(document.createElement("br"));
    //}
    



    //function streamlineAccountReg_onClick() {
    //    WL.login({
    //        scope: ["wl.signin", "wl.basic", "wl.birthday", "wl.emails"]
    //    }).then(
    //        function (response) {
    //            WL.api({
    //                path: "me",
    //                method: "GET"
    //            }).then(
    //                function (response) {
    //                    document.getElementById("first_name").innerText = response.first_name;
    //                    document.getElementById("last_name").innerText = response.last_name;
    //                    document.getElementById("email").innerText = response.emails.preferred;
    //                    document.getElementById("gender").innerText = response.gender;
    //                    document.getElementById("birthday").innerText =
    //                        response.birth_month + " " + response.birth_day + " " + response.birth_year;
    //                },
    //                function (responseFailed) {
    //                    document.getElementById("infoArea").innerText =
    //                        "Error calling API: " + responseFailed.error.message;
    //                }
    //            );
    //        },
    //        function (responseFailed) {
    //            document.getElementById("infoArea").innerText =
    //                "Error signing in: " + responseFailed.error_description;
    //        }
    //    );
    //}
    



</script>

@section Scripts {
    @Scripts.Render("~/bundles/jqueryval")
}

